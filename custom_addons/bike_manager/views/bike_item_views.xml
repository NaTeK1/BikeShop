<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire pour un vélo individuel -->
    <record id="view_bike_item_form" model="ir.ui.view">
        <field name="name">bike.item.form</field>
        <field name="model">bike.item</field>
        <field name="arch" type="xml">
            <form string="Vélo individuel">
                <header>
                    <button name="action_send_to_maintenance" string="Envoyer en maintenance" type="object"
                            class="oe_highlight" invisible="status in ['maintenance', 'rented', 'sold']"
                            groups="bike_manager.group_bike_manager"/>
                    <button name="action_return_from_maintenance" string="Retour de maintenance" type="object"
                            class="oe_highlight" invisible="status != 'maintenance'"
                            groups="bike_manager.group_bike_manager"/>
                    <button name="action_mark_as_sold" string="Marquer comme vendu" type="object"
                            invisible="status in ['sold', 'rented']"
                            groups="bike_manager.group_bike_manager"/>
                    <field name="status" widget="statusbar" statusbar_visible="available,rented,maintenance,sold"/>
                </header>
                <sheet>
                    <group>
                        <field name="serial_number" placeholder="Ex: BIKE-2025-001"/>
                        <field name="product_id"/>
                        <field name="bike_model_id"/>
                        <field name="category_id"/>
                        <field name="usage_type"/>
                        <field name="condition" groups="bike_manager.group_bike_manager"/>
                        <field name="location" placeholder="Ex: Magasin principal, Entrepôt A..." groups="bike_manager.group_bike_manager"/>
                        <field name="purchase_date" groups="bike_manager.group_bike_manager"/>
                        <field name="purchase_price" groups="bike_manager.group_bike_manager"/>
                        <field name="sale_price"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Vue liste (tree) -->
    <record id="view_bike_item_tree" model="ir.ui.view">
        <field name="name">bike.item.tree</field>
        <field name="model">bike.item</field>
        <field name="arch" type="xml">
            <list string="Vélos individuels"
                  decoration-success="status == 'available'"
                  decoration-info="status == 'rented'"
                  decoration-warning="status == 'maintenance'"
                  decoration-muted="status == 'sold'">
                <field name="serial_number"/>
                <field name="product_id"/>
                <field name="bike_model_id"/>
                <field name="category_id"/>
                <field name="usage_type"/>
                <field name="condition"
                       decoration-success="condition == 'excellent'"
                       decoration-warning="condition in ['fair', 'poor']"/>
                <field name="status" widget="badge"
                       decoration-success="status == 'available'"
                       decoration-info="status == 'rented'"
                       decoration-warning="status == 'maintenance'"
                       decoration-danger="status == 'sold'"/>
                <field name="location" groups="bike_manager.group_bike_manager"/>
                <field name="rental_count" groups="bike_manager.group_bike_manager"/>
                <field name="sale_price" optional="hide"/>
                <field name="purchase_date" optional="hide" groups="bike_manager.group_bike_manager"/>
            </list>
        </field>
    </record>

    <!-- Vue kanban -->
    <record id="view_bike_item_kanban" model="ir.ui.view">
        <field name="name">bike.item.kanban</field>
        <field name="model">bike.item</field>
        <field name="arch" type="xml">
            <kanban string="Vélos">
                <field name="product_id"/>
                <field name="status"/>
                <field name="condition"/>
                <field name="image_1920"/>
                <field name="sale_price"/>

                <templates>
                    <t t-name="card">
                        <div class="oe_kanban_global_click">
                            <div class="o_kanban_image mb-3">
                                <field name="image_1920" widget="image" options="{'size': [300, 300]}"/>
                            </div>
                            <div class="o_kanban_details text-center">
                                <strong class="d-block mb-2">
                                    <field name="product_id"/>
                                </strong>
                                <div class="mb-2">
                                    <field name="status" widget="badge"
                                           decoration-success="status == 'available'"
                                           decoration-info="status == 'rented'"
                                           decoration-warning="status == 'maintenance'"
                                           decoration-danger="status == 'sold'"/>
                                    <span class="badge text-bg-light ms-1">
                                        <field name="condition"/>
                                    </span>
                                </div>
                                <div class="fs-4 fw-bold text-primary">
                                    <field name="sale_price"/> €
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Action pour ouvrir les vélos individuels -->
    <record id="action_bike_item" model="ir.actions.act_window">
        <field name="name">Vélos individuels</field>
        <field name="res_model">bike.item</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Créer un nouveau vélo individuel
            </p>
            <p>
                Chaque vélo physique de votre magasin doit être enregistré ici avec son numéro de série unique.
                Cela permet de suivre précisément quel vélo est loué, vendu, ou en maintenance.
            </p>
        </field>
    </record>

</odoo>
